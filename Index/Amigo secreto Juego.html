<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amigo Secreto Navide√±o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-y: auto;
        }

        .bg-particle {
            position: fixed;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            pointer-events: none;
            animation: particleFloat 15s infinite ease-in-out;
        }

        @keyframes particleFloat {
            0%, 100% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% {
                transform: translateY(-100vh) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }

        .main-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.4);
            padding: 50px;
            max-width: 550px;
            width: 100%;
            text-align: center;
            animation: containerSlide 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
            margin: 40px 0;
        }

        .main-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: containerShine 3s infinite;
        }

        @keyframes containerShine {
            0% { left: -100%; }
            50%, 100% { left: 100%; }
        }

        @keyframes containerSlide {
            from {
                opacity: 0;
                transform: translateY(100px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .main-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            font-size: 2.8em;
            animation: titleScale 2s ease-in-out infinite;
        }

        @keyframes titleScale {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .subtitle {
            color: #764ba2;
            margin-bottom: 30px;
            font-size: 2em;
            animation: subtitleFade 0.6s ease-out;
        }

        @keyframes subtitleFade {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .description-text {
            color: #555;
            font-size: 1.2em;
            margin-bottom: 35px;
            line-height: 1.8;
            animation: textFade 1s ease-out 0.3s both;
        }

        @keyframes textFade {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .action-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.3em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
            animation: textFade 1s ease-out 0.5s both;
            margin-top: 20px;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .action-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .action-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }

        .action-btn:active {
            transform: translateY(-2px) scale(1.02);
        }

        .name-input {
            width: 100%;
            padding: 18px;
            font-size: 1.2em;
            border: 3px solid #ddd;
            border-radius: 15px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            animation: textFade 0.6s ease-out 0.2s both;
        }

        .name-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
            transform: scale(1.02);
        }

        .hide {
            display: none;
        }

        .friend-reveal-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 40px;
            border-radius: 20px;
            margin: 30px 0;
            box-shadow: 0 15px 40px rgba(245, 87, 108, 0.4);
            animation: boxReveal 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
        }

        @keyframes boxReveal {
            0% {
                opacity: 0;
                transform: rotateX(90deg) scale(0.5);
            }
            50% {
                transform: rotateX(-10deg) scale(1.1);
            }
            100% {
                opacity: 1;
                transform: rotateX(0deg) scale(1);
            }
        }

        .friend-name-display {
            color: white;
            font-size: 2.5em;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            animation: nameGlowEffect 1.5s ease-in-out infinite;
        }

        @keyframes nameGlowEffect {
            0%, 100% {
                text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            }
            50% {
                text-shadow: 0 0 20px rgba(255,255,255,0.8), 3px 3px 6px rgba(0,0,0,0.3);
            }
        }

        .screenshot-reminder {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 3px solid #ffc107;
            color: #856404;
            padding: 20px;
            border-radius: 15px;
            font-weight: bold;
            margin-top: 20px;
            animation: reminderPulse 2s ease-in-out infinite;
            box-shadow: 0 5px 20px rgba(255, 193, 7, 0.3);
        }

        @keyframes reminderPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 5px 20px rgba(255, 193, 7, 0.3);
            }
            50% {
                transform: scale(1.03);
                box-shadow: 0 8px 30px rgba(255, 193, 7, 0.5);
            }
        }

        .emoji-icon {
            font-size: 4em;
            margin-bottom: 20px;
            display: inline-block;
            animation: iconBounceAnim 2s ease-in-out infinite;
        }

        @keyframes iconBounceAnim {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            25% {
                transform: translateY(-20px) rotate(-10deg);
            }
            75% {
                transform: translateY(-10px) rotate(10deg);
            }
        }

        .input-error-msg {
            color: #f5576c;
            font-size: 1em;
            margin-top: -15px;
            margin-bottom: 15px;
            animation: errorShake 0.5s ease-in-out;
        }

        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .celebration-confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f0f;
            animation: confettiDrop 3s linear infinite;
        }

        @keyframes confettiDrop {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .regalo-sorpresa {
            position: fixed;
            bottom: 30px;
            right: 30px;
            cursor: pointer;
            animation: regaloFloat 3s ease-in-out infinite;
            transition: transform 0.3s ease;
            z-index: 1000;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3));
            text-align: center;
        }

        .regalo-icon {
            font-size: 5em;
            display: block;
            margin-bottom: -10px;
        }

        .regalo-texto {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.1em;
            box-shadow: 0 5px 20px rgba(238, 90, 111, 0.4);
            animation: textoParpadeo 1.5s ease-in-out infinite;
        }

        @keyframes textoParpadeo {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.05);
            }
        }

        .regalo-sorpresa:hover {
            transform: scale(1.15);
            animation: regaloShake 0.5s ease-in-out infinite;
        }

        .regalo-sorpresa:hover .regalo-icon {
            animation: iconoRotar 0.5s ease-in-out infinite;
        }

        @keyframes iconoRotar {
            0%, 100% {
                transform: rotate(0deg);
            }
            25% {
                transform: rotate(-20deg);
            }
            75% {
                transform: rotate(20deg);
            }
        }

        @keyframes regaloFloat {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-15px);
            }
        }

        @keyframes regaloShake {
            0%, 100% {
                transform: scale(1.15) rotate(0deg);
            }
            25% {
                transform: scale(1.15) rotate(-10deg);
            }
            75% {
                transform: scale(1.15) rotate(10deg);
            }
        }

        /* Panel de administrador */
        .panel-admin {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 1000;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .panel-admin:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.05);
        }

        .modal-contrasena {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .contenedor-contrasena {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .input-contrasena {
            width: 100%;
            padding: 15px;
            margin: 20px 0;
            font-size: 1.2em;
            border: 2px solid #667eea;
            border-radius: 10px;
            text-align: center;
        }

        .boton-contrasena {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }

        .boton-contrasena:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .boton-cerrar {
            background: #f5576c;
        }

        /* Para scroll en m√≥viles */
        @media (max-height: 700px) {
            .main-container {
                padding: 30px;
                margin: 20px 0;
            }
            
            .main-title {
                font-size: 2.2em;
            }
            
            .subtitle {
                font-size: 1.6em;
            }
            
            .emoji-icon {
                font-size: 3em;
            }
            
            .friend-name-display {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <!-- Panel de administrador (oculto por defecto) -->
    <div class="panel-admin hide" onclick="abrirPanelAdmin()">
        <span>üëÅÔ∏è</span>
        <span>Ver Grupos</span>
    </div>

    <script>
        // generar particulas de animacion
        for(let i = 0; i < 20; i++) {
            const part = document.createElement('div');
            part.className = 'bg-particle';
            part.style.width = Math.random() * 50 + 10 + 'px';
            part.style.height = part.style.width;
            part.style.left = Math.random() * 100 + '%';
            part.style.animationDelay = Math.random() * 15 + 's';
            part.style.animationDuration = (Math.random() * 10 + 10) + 's';
            document.body.appendChild(part);
        }
    </script>

    <div id="welcomeView" class="main-container">
        <div class="emoji-icon">üéÅ</div>
        <h1 class="main-title">Amigo Secreto Navide√±o</h1>
        <p class="description-text">
            Descubre qui√©n ser√° tu amigo secreto.
        </p>
        <button class="action-btn" onclick="iniciarJuego()">COMENZAR</button>
    </div>

    <div id="gameView" class="main-container hide">
        <div class="emoji-icon">üéÖ</div>
        <h2 class="subtitle">¬øCu√°l es tu nombre?</h2>
        <input type="text" id="nombreUsuario" class="name-input" placeholder="Escribe tu nombre aqu√≠..." />
        <div id="mensajeError" class="input-error-msg hide"></div>
        <button class="action-btn" onclick="asignarAmigoSecreto()">DESCUBRIR AMIGO SECRETO</button>
    </div>

    <div id="resultView" class="main-container hide">
        <div class="emoji-icon">‚ú®</div>
        <h2 class="subtitle">¬°Tu Amigo Secreto es!</h2>
        <div class="friend-reveal-box">
            <div class="friend-name-display" id="nombreAmigoSecreto"></div>
        </div>
        <div class="screenshot-reminder">
            üì∏ ¬°Guarda este resultado! Toma una captura de pantalla.
        </div>
        <button class="action-btn" onclick="volverAlInicio()">VOLVER AL INICIO</button>
    </div>

    <!-- Regalo sorpresa -->
    <div id="regaloSorpresa" class="regalo-sorpresa hide" onclick="abrirRegalo()">
        <span class="regalo-icon">üéÅ</span>
        <div class="regalo-texto">SORPRESA</div>
    </div>

    <script>
        // ===========================================
        // CONFIGURACI√ìN IMPORTANTE - CAMBIA ESTO
        // ===========================================
        
        // 1. CONTRASE√ëA PARA VER GRUPOS (C√ÅMBIALA POR UNA SEGURA)
        const CONTRASENA_ADMIN = "familia2024"; // ‚Üê ¬°CAMBIA ESTA CONTRASE√ëA!
        
        // 2. ENLACE DEL REGALO SORPRESA
        const ENLACE_REGALO = "https://www.youtube.com/watch?v=M-OD3dMdqqw"; // ‚Üê Cambia por tu video
        
        // ===========================================
        // LISTA DE PARTICIPANTES
        // ===========================================
        const participantes = [
            "Sandra",
            "Jorge", 
            "Samali",
            "Rodrigo",
            "Yansy",
            "Sa√∫l",
            "Carlos",
            "Nohemy",
            "Danilo",
            "Xiomara",
            "Silvia",
            "Dora",
            "Pap√°",
            "Mam√°",
            "Bladimir"
        ];

        // Variables del juego
        let asignaciones = {};
        let yaAsignados = [];

        // Cargar datos al iniciar
        window.onload = function() {
            // Mostrar panel admin solo si es el creador
            const esCreador = localStorage.getItem('esCreador') === 'true' || 
                            window.location.href.includes('localhost') ||
                            window.location.href.includes('127.0.0.1');
            
            if (esCreador) {
                document.querySelector('.panel-admin').classList.remove('hide');
            }

            // Cargar datos guardados
            const miNombre = localStorage.getItem('miNombre');
            const miAmigo = localStorage.getItem('miAmigoSecreto');
            const asignacionesGuardadas = localStorage.getItem('asignacionesCompletas');
            const yaAsignadosGuardados = localStorage.getItem('yaAsignadosLista');
            
            // Si ya jug√≥, mostrar resultado
            if (miNombre && miAmigo) {
                document.getElementById('welcomeView').classList.add('hide');
                document.getElementById('gameView').classList.add('hide');
                document.getElementById('resultView').classList.remove('hide');
                document.getElementById('nombreAmigoSecreto').textContent = miAmigo;
                document.getElementById('regaloSorpresa').classList.remove('hide');
            }
            
            // Cargar asignaciones globales
            if (asignacionesGuardadas) {
                asignaciones = JSON.parse(asignacionesGuardadas);
            }
            if (yaAsignadosGuardados) {
                yaAsignados = JSON.parse(yaAsignadosGuardados);
            }
        };

        function iniciarJuego() {
            document.getElementById('welcomeView').style.animation = 'containerSlide 0.5s ease-out reverse';
            setTimeout(() => {
                document.getElementById('welcomeView').classList.add('hide');
                document.getElementById('gameView').classList.remove('hide');
                document.getElementById('nombreUsuario').focus();
                window.scrollTo(0, 0);
            }, 500);
        }

        function asignarAmigoSecreto() {
            const inputNombre = document.getElementById('nombreUsuario');
            const nombre = inputNombre.value.trim();
            const msgError = document.getElementById('mensajeError');

            // Validaciones
            if (!nombre) {
                mostrarError('Por favor ingresa tu nombre');
                return;
            }

            if (!participantes.includes(nombre)) {
                mostrarError('Tu nombre no est√° en la lista de participantes');
                return;
            }

            msgError.classList.add('hide');

            // Verificar si ya tiene asignaci√≥n
            if (asignaciones[nombre]) {
                mostrarResultado(nombre, asignaciones[nombre]);
                return;
            }

            // Buscar opciones disponibles
            let opciones = participantes.filter(p => 
                p !== nombre && !yaAsignados.includes(p)
            );

            if (opciones.length === 0) {
                mostrarError('Todos los participantes ya tienen asignado un amigo secreto');
                return;
            }

            // Asignar aleatoriamente
            const indiceAleatorio = Math.floor(Math.random() * opciones.length);
            const amigoSecreto = opciones[indiceAleatorio];

            // Guardar asignaci√≥n
            asignaciones[nombre] = amigoSecreto;
            yaAsignados.push(amigoSecreto);

            // Guardar en localStorage
            localStorage.setItem('asignacionesCompletas', JSON.stringify(asignaciones));
            localStorage.setItem('yaAsignadosLista', JSON.stringify(yaAsignados));

            mostrarResultado(nombre, amigoSecreto);
        }

        function mostrarError(mensaje) {
            const msgError = document.getElementById('mensajeError');
            const inputNombre = document.getElementById('nombreUsuario');
            
            msgError.textContent = mensaje;
            msgError.classList.remove('hide');
            inputNombre.style.animation = 'errorShake 0.5s ease-in-out';
            setTimeout(() => inputNombre.style.animation = '', 500);
        }

        function mostrarResultado(persona, amigo) {
            // Guardar para este usuario
            localStorage.setItem('miNombre', persona);
            localStorage.setItem('miAmigoSecreto', amigo);
            
            // Transici√≥n
            document.getElementById('gameView').style.animation = 'containerSlide 0.5s ease-out reverse';
            setTimeout(() => {
                document.getElementById('gameView').classList.add('hide');
                document.getElementById('resultView').classList.remove('hide');
                document.getElementById('nombreAmigoSecreto').textContent = amigo;
                
                // Efectos
                lanzarConfetti();
                
                // Mostrar regalo despu√©s de 2 segundos
                setTimeout(() => {
                    document.getElementById('regaloSorpresa').classList.remove('hide');
                }, 2000);
                
                window.scrollTo(0, 0);
            }, 500);
        }

        function volverAlInicio() {
            const vistaActual = document.querySelector('.main-container:not(.hide)');
            vistaActual.style.animation = 'containerSlide 0.5s ease-out reverse';
            
            setTimeout(() => {
                vistaActual.classList.add('hide');
                document.getElementById('welcomeView').classList.remove('hide');
                document.getElementById('regaloSorpresa').classList.add('hide');
                window.scrollTo(0, 0);
            }, 500);
        }

        function abrirRegalo() {
            window.open(ENLACE_REGALO, '_blank');
        }

        function lanzarConfetti() {
            const colores = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#ffc107'];
            for(let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const conf = document.createElement('div');
                    conf.className = 'celebration-confetti';
                    conf.style.left = Math.random() * 100 + '%';
                    conf.style.background = colores[Math.floor(Math.random() * colores.length)];
                    conf.style.animationDelay = Math.random() * 2 + 's';
                    document.body.appendChild(conf);
                    setTimeout(() => conf.remove(), 3000);
                }, i * 30);
            }
        }

        // ===========================================
        // FUNCIONES DE ADMINISTRADOR
        // ===========================================

        function abrirPanelAdmin() {
            const modal = document.createElement('div');
            modal.className = 'modal-contrasena';
            modal.innerHTML = `
                <div class="contenedor-contrasena">
                    <h2 style="color: #764ba2; margin-bottom: 20px;">üîê Acceso Administrador</h2>
                    <p>Ingresa la contrase√±a para ver los grupos:</p>
                    <input type="password" id="inputContrasena" class="input-contrasena" 
                           placeholder="Contrase√±a" autocomplete="off" />
                    <div style="margin-top: 25px;">
                        <button class="boton-contrasena" onclick="verificarContrasena()">VER GRUPOS</button>
                        <button class="boton-contrasena boton-cerrar" onclick="cerrarModal()">CANCELAR</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            document.getElementById('inputContrasena').focus();
        }

        function verificarContrasena() {
            const input = document.getElementById('inputContrasena');
            const contrasenaIngresada = input.value.trim();
            
            if (contrasenaIngresada === CONTRASENA_ADMIN) {
                cerrarModal();
                mostrarTodosLosGrupos();
            } else {
                alert('‚ùå Contrase√±a incorrecta');
                input.value = '';
                input.focus();
            }
        }

        function cerrarModal() {
            const modal = document.querySelector('.modal-contrasena');
            if (modal) {
                modal.remove();
            }
        }

        function mostrarTodosLosGrupos() {
            if (Object.keys(asignaciones).length === 0) {
                alert('üìä No hay asignaciones a√∫n.\n\nEsperando que los participantes se registren.');
                return;
            }
            
            let mensaje = 'üéÖ ASIGNACIONES DE AMIGO SECRETO üìä\n\n';
            let contador = 1;
            
            // Ordenar alfab√©ticamente
            const asignacionesOrdenadas = Object.entries(asignaciones)
                .sort((a, b) => a[0].localeCompare(b[0]));
            
            for (const [persona, amigo] of asignacionesOrdenadas) {
                mensaje += `${contador}. ${persona} ‚Üí ${amigo}\n`;
                contador++;
            }
            
            // Estad√≠sticas
            mensaje += `\nüìà ESTAD√çSTICAS:\n`;
            mensaje += `   ‚Ä¢ Total asignados: ${Object.keys(asignaciones).length} de ${participantes.length}\n`;
            mensaje += `   ‚Ä¢ Porcentaje: ${Math.round((Object.keys(asignaciones).length / participantes.length) * 100)}%\n`;
            
            if (Object.keys(asignaciones).length === participantes.length) {
                mensaje += '\nüéâ ¬°TODOS LOS PARTICIPANTES YA TIENEN ASIGNACI√ìN!\n';
                mensaje += '   El sorteo est√° completo.';
            } else {
                const faltantes = participantes.filter(p => !asignaciones[p] && !yaAsignados.includes(p));
                mensaje += `\n‚è∞ FALTAN POR ASIGNAR: ${faltantes.length}\n`;
                mensaje += `   Pendientes: ${faltantes.join(', ')}`;
            }
            
            // Mostrar y ofrecer descarga
            alert(mensaje);
            
            if (confirm('¬øDeseas descargar un reporte con esta informaci√≥n?')) {
                descargarReporte(asignacionesOrdenadas, faltantes || []);
            }
        }

        function descargarReporte(asignacionesOrdenadas, faltantes) {
            const fecha = new Date().toLocaleDateString('es-ES', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            const hora = new Date().toLocaleTimeString('es-ES');
            
            let contenido = `REPORTE DE AMIGO SECRETO\n`;
            contenido += `Fecha: ${fecha}\n`;
            contenido += `Hora: ${hora}\n`;
            contenido += `=================================\n\n`;
            contenido += `ASIGNACIONES REALIZADAS:\n`;
            contenido += `========================\n\n`;
            
            asignacionesOrdenadas.forEach(([persona, amigo], index) => {
                contenido += `${index + 1}. ${persona} ‚Üí ${amigo}\n`;
            });
            
            contenido += `\n\nESTAD√çSTICAS:\n`;
            contenido += `=============\n`;
            contenido += `‚Ä¢ Total participantes: ${participantes.length}\n`;
            contenido += `‚Ä¢ Total asignados: ${asignacionesOrdenadas.length}\n`;
            contenido += `‚Ä¢ Porcentaje: ${Math.round((asignacionesOrdenadas.length / participantes.length) * 100)}%\n`;
            
            if (faltantes.length > 0) {
                contenido += `\n\nFALTAN POR ASIGNAR (${faltantes.length}):\n`;
                contenido += `=============================\n`;
                contenido += `${faltantes.join(', ')}\n`;
            }
            
            contenido += `\n\n¬© Sorteo Navide√±o - Generado autom√°ticamente`;
            
            const blob = new Blob([contenido], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `amigo_secreto_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Atajos de teclado para administrador
        document.addEventListener('keydown', function(e) {
            // Ctrl + Alt + A (mostrar todos los grupos)
            if (e.ctrlKey && e.altKey && e.key === 'a') {
                abrirPanelAdmin();
            }
            // Ctrl + Alt + R (reiniciar - con confirmaci√≥n)
            if (e.ctrlKey && e.altKey && e.key === 'r') {
                if (confirm('¬øReiniciar todas las asignaciones?\n\nEsto borrar√° todo el progreso.')) {
                    const contrasena = prompt('Contrase√±a de administrador:');
                    if (contrasena === CONTRASENA_ADMIN) {
                        localStorage.clear();
                        asignaciones = {};
                        yaAsignados = [];
                        alert('‚úÖ Juego reiniciado exitosamente.');
                        location.reload();
                    } else {
                        alert('‚ùå Contrase√±a incorrecta');
                    }
                }
            }
        });

        // Enter para enviar nombre
        document.getElementById('nombreUsuario').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                asignarAmigoSecreto();
            }
        });

        // Detectar si es el creador (para mostrar panel admin)
        // Esto se activa manualmente en la consola si es necesario
        window.mostrarPanelAdmin = function() {
            localStorage.setItem('esCreador', 'true');
            document.querySelector('.panel-admin').classList.remove('hide');
            alert('Panel de administrador activado');
        };
    </script>
</body>
</html>